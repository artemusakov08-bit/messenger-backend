const rateLimit = require('express-rate-limit');

// üõ°Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
exports.securityActions = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  max: 5, // 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 15 –º–∏–Ω—É—Ç
  message: {
    success: false,
    error: '–°–õ–ò–®–ö–û–ú_–ú–ù–û–ì–û_–ü–û–ü–´–¢–û–ö',
    message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.'
  },
  standardHeaders: true,
  legacyHeaders: false
});

// üîê –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
exports.securityVerification = rateLimit({
  windowMs: 10 * 60 * 1000, // 10 –º–∏–Ω—É—Ç
  max: 10, // 10 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 10 –º–∏–Ω—É—Ç
  message: {
    success: false,
    error: '–°–õ–ò–®–ö–û–ú_–ú–ù–û–ì–û_–ü–û–ü–´–¢–û–ö_–í–ï–†–ò–§–ò–ö–ê–¶–ò–ò',
    message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10 –º–∏–Ω—É—Ç.'
  }
});

// üìß –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS/email
exports.verificationCodes = rateLimit({
  windowMs: 5 * 60 * 1000, // 5 –º–∏–Ω—É—Ç
  max: 3, // 3 SMS –∑–∞ 5 –º–∏–Ω—É—Ç
  message: {
    success: false,
    error: '–°–õ–ò–®–ö–û–ú_–ú–ù–û–ì–û_–ó–ê–ü–†–û–°–û–í_–ö–û–î–û–í',
    message: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–æ–¥–æ–≤. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5 –º–∏–Ω—É—Ç.'
  }
});